name: ğŸ§  AI Analyst (Daily 6am)

on:
  schedule:
    - cron: '10 22 * * *'
  workflow_dispatch:

permissions:
  contents: write

jobs:
  ai-job:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ ä¸‹è½½ä»£ç 
        uses: actions/checkout@v3

      - name: ğŸ è®¾ç½® Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: ğŸ“¦ å®‰è£…ä¾èµ–
        # å¼ºåˆ¶å®‰è£…æœ€æ–°ç‰ˆåº“ï¼Œé˜²æ­¢æŠ¥ 404 é”™è¯¯
        run: pip install requests google-generativeai>=0.7.2

      - name: ğŸ§  è¿è¡Œ AI åˆ†æ
        env:
          KEY_FINANCE: ${{ secrets.KEY_FINANCE }}
          KEY_GLOBAL: ${{ secrets.KEY_GLOBAL }}
          KEY_TECH: ${{ secrets.KEY_TECH }}
          KEY_GENERAL: ${{ secrets.KEY_GENERAL }}
          GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}
        run: python ai_editor.py

      - name: ğŸ’¾ ä¿å­˜æŠ¥å‘Š
        run: |
          git config --global user.name 'AI Analyst'
          git config --global user.email 'ai@bot.com'
          git add analysis_*.json
          git commit -m "ğŸ§  Auto-update: AI Report (Multi-Key)" || exit 0
          
          # â¬‡ï¸â¬‡ï¸â¬‡ï¸ å…³é”®ä¿®å¤ç‚¹ï¼šå…ˆæ‹‰å–æœ€æ–°ä»£ç ï¼Œåˆå¹¶å†²çª â¬‡ï¸â¬‡ï¸â¬‡ï¸
          git pull --rebase origin main
          
          git push
